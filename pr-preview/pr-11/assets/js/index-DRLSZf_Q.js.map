{"version":3,"file":"index-DRLSZf_Q.js","sources":["../../../src/hooks/useMobileCanvas.ts","../../../src/components/forms/yarn-parameters.tsx","../../../src/App.tsx","../../../src/main.tsx"],"sourcesContent":["import { useRef, useCallback, useEffect, useState } from 'react'\n\nexport interface CanvasTransform {\n  scale: number\n  translateX: number\n  translateY: number\n}\n\nexport interface UseMobileCanvasOptions {\n  minScale?: number\n  maxScale?: number\n  enablePan?: boolean\n  enableZoom?: boolean\n  smoothness?: number\n  resetOnDoubleClick?: boolean\n}\n\nexport interface MobileCanvasHandlers {\n  onTouchStart: (event: React.TouchEvent<HTMLCanvasElement>) => void\n  onTouchMove: (event: React.TouchEvent<HTMLCanvasElement>) => void\n  onTouchEnd: (event: React.TouchEvent<HTMLCanvasElement>) => void\n  onWheel: (event: React.WheelEvent<HTMLCanvasElement>) => void\n  onDoubleClick: (event: React.MouseEvent<HTMLCanvasElement>) => void\n  resetTransform: () => void\n  setTransform: (transform: Partial<CanvasTransform>) => void\n}\n\nexport function useMobileCanvas(options: UseMobileCanvasOptions = {}): [\n  React.RefObject<HTMLCanvasElement | null>,\n  CanvasTransform,\n  MobileCanvasHandlers\n] {\n  const {\n    minScale = 0.5,\n    maxScale = 4,\n    enablePan = true,\n    enableZoom = true,\n    resetOnDoubleClick = true,\n  } = options\n\n  const canvasRef = useRef<HTMLCanvasElement>(null)\n  const [transform, setTransformState] = useState<CanvasTransform>({\n    scale: 1,\n    translateX: 0,\n    translateY: 0,\n  })\n\n  // Touch tracking state\n  const lastTouchesRef = useRef<React.Touch[]>([])\n  const lastDistanceRef = useRef<number>(0)\n  const isPanningRef = useRef<boolean>(false)\n  const isZoomingRef = useRef<boolean>(false)\n  const animationFrameRef = useRef<number | undefined>(undefined)\n  const visualFeedbackTimeoutRef = useRef<NodeJS.Timeout | undefined>(undefined)\n\n  // Get distance between two touches\n  const getTouchDistance = useCallback((touch1: React.Touch, touch2: React.Touch): number => {\n    const dx = touch1.clientX - touch2.clientX\n    const dy = touch1.clientY - touch2.clientY\n    return Math.sqrt(dx * dx + dy * dy)\n  }, [])\n\n  // Get center point between two touches\n  const getTouchCenter = useCallback((touch1: React.Touch, touch2: React.Touch): { x: number; y: number } => {\n    return {\n      x: (touch1.clientX + touch2.clientX) / 2,\n      y: (touch1.clientY + touch2.clientY) / 2,\n    }\n  }, [])\n\n  // Constrain scale within bounds\n  const constrainScale = useCallback((scale: number): number => {\n    return Math.max(minScale, Math.min(maxScale, scale))\n  }, [minScale, maxScale])\n\n  // Constrain pan within canvas bounds\n  const constrainPan = useCallback((translateX: number, translateY: number, scale: number): { x: number; y: number } => {\n    if (!canvasRef.current) return { x: translateX, y: translateY }\n\n    const canvas = canvasRef.current\n    const rect = canvas.getBoundingClientRect()\n    \n    // Calculate the scaled canvas dimensions\n    const scaledWidth = rect.width * scale\n    const scaledHeight = rect.height * scale\n    \n    // Maximum translation limits\n    const maxTranslateX = Math.max(0, (scaledWidth - rect.width) / 2)\n    const maxTranslateY = Math.max(0, (scaledHeight - rect.height) / 2)\n    \n    return {\n      x: Math.max(-maxTranslateX, Math.min(maxTranslateX, translateX)),\n      y: Math.max(-maxTranslateY, Math.min(maxTranslateY, translateY))\n    }\n  }, [])\n\n  // Smooth transform update with RAF\n  const updateTransform = useCallback((newTransform: Partial<CanvasTransform>) => {\n    setTransformState(current => {\n      const updated = { ...current, ...newTransform }\n      \n      // Constrain scale\n      updated.scale = constrainScale(updated.scale)\n      \n      // Constrain pan\n      const constrainedPan = constrainPan(updated.translateX, updated.translateY, updated.scale)\n      updated.translateX = constrainedPan.x\n      updated.translateY = constrainedPan.y\n      \n      return updated\n    })\n  }, [constrainScale, constrainPan])\n\n  // Touch start handler\n  const onTouchStart = useCallback((event: React.TouchEvent<HTMLCanvasElement>) => {\n    // Only preventDefault if the event is cancelable (not passive)\n    if (event.cancelable) {\n      event.preventDefault()\n    }\n    \n    const touches = Array.from(event.touches)\n    lastTouchesRef.current = touches\n\n    if (touches.length === 1) {\n      // Single touch - start panning\n      isPanningRef.current = true\n      isZoomingRef.current = false\n    } else if (touches.length === 2 && enableZoom) {\n      // Two touches - start zooming\n      isPanningRef.current = false\n      isZoomingRef.current = true\n      lastDistanceRef.current = getTouchDistance(touches[0], touches[1])\n    }\n\n    // Add visual feedback with proper cleanup\n    const canvas = event.currentTarget\n    canvas.style.filter = 'brightness(0.95)'\n    \n    // Clear any existing visual feedback timeout\n    if (visualFeedbackTimeoutRef.current) {\n      clearTimeout(visualFeedbackTimeoutRef.current)\n    }\n  }, [enableZoom, getTouchDistance])\n\n  // Touch move handler\n  const onTouchMove = useCallback((event: React.TouchEvent<HTMLCanvasElement>) => {\n    // Only preventDefault if the event is cancelable (not passive)\n    if (event.cancelable) {\n      event.preventDefault()\n    }\n    \n    const touches = Array.from(event.touches)\n    const lastTouches = lastTouchesRef.current\n\n    if (touches.length === 1 && lastTouches.length === 1 && enablePan && isPanningRef.current) {\n      // Single touch pan\n      const touch = touches[0]\n      const lastTouch = lastTouches[0]\n      \n      const deltaX = touch.clientX - lastTouch.clientX\n      const deltaY = touch.clientY - lastTouch.clientY\n      \n      updateTransform({\n        translateX: transform.translateX + deltaX,\n        translateY: transform.translateY + deltaY\n      })\n    } else if (touches.length === 2 && lastTouches.length === 2 && enableZoom && isZoomingRef.current) {\n      // Two touch zoom and pan\n      const currentDistance = getTouchDistance(touches[0], touches[1])\n      const lastDistance = lastDistanceRef.current\n      \n      if (lastDistance > 0) {\n        // Calculate zoom\n        const scaleChange = currentDistance / lastDistance\n        const newScale = transform.scale * scaleChange\n        \n        // Get center point for zoom origin\n        const center = getTouchCenter(touches[0], touches[1])\n        const canvas = event.currentTarget\n        const rect = canvas.getBoundingClientRect()\n        const originX = center.x - rect.left - rect.width / 2\n        const originY = center.y - rect.top - rect.height / 2\n        \n        // Apply zoom with origin point\n        const scaleDiff = newScale - transform.scale\n        const newTranslateX = transform.translateX - originX * scaleDiff / transform.scale\n        const newTranslateY = transform.translateY - originY * scaleDiff / transform.scale\n        \n        updateTransform({\n          scale: newScale,\n          translateX: newTranslateX,\n          translateY: newTranslateY\n        })\n      }\n      \n      lastDistanceRef.current = currentDistance\n    }\n\n    lastTouchesRef.current = touches\n  }, [\n    enablePan, \n    enableZoom, \n    isPanningRef, \n    isZoomingRef, \n    transform, \n    getTouchDistance, \n    getTouchCenter, \n    updateTransform\n  ])\n\n  // Touch end handler\n  const onTouchEnd = useCallback((event: React.TouchEvent<HTMLCanvasElement>) => {\n    // Only preventDefault if the event is cancelable (not passive)\n    if (event.cancelable) {\n      event.preventDefault()\n    }\n    \n    const touches = Array.from(event.touches)\n    lastTouchesRef.current = touches\n\n    if (touches.length === 0) {\n      // All touches ended - clear touch references to prevent leaks\n      isPanningRef.current = false\n      isZoomingRef.current = false\n      lastDistanceRef.current = 0\n      lastTouchesRef.current = [] // Clear touch references\n    } else if (touches.length === 1) {\n      // Switch from zoom to pan\n      isPanningRef.current = true\n      isZoomingRef.current = false\n      lastDistanceRef.current = 0\n    }\n\n    // Remove visual feedback with timeout cleanup\n    const canvas = event.currentTarget\n    canvas.style.filter = 'brightness(1)'\n    canvas.style.transform = 'scale(1)'\n    \n    // Clear any pending visual feedback timeouts\n    if (visualFeedbackTimeoutRef.current) {\n      clearTimeout(visualFeedbackTimeoutRef.current)\n      visualFeedbackTimeoutRef.current = undefined\n    }\n  }, [])\n\n  // Mouse wheel handler for desktop\n  const onWheel = useCallback((event: React.WheelEvent<HTMLCanvasElement>) => {\n    if (!enableZoom) return\n    \n    // Only preventDefault if the event is cancelable (not passive)\n    if (event.cancelable) {\n      event.preventDefault()\n    }\n    \n    const delta = event.deltaY > 0 ? 0.9 : 1.1\n    const newScale = transform.scale * delta\n    \n    // Get mouse position for zoom origin\n    const canvas = event.currentTarget\n    const rect = canvas.getBoundingClientRect()\n    const originX = event.clientX - rect.left - rect.width / 2\n    const originY = event.clientY - rect.top - rect.height / 2\n    \n    // Apply zoom with origin point\n    const scaleDiff = newScale - transform.scale\n    const newTranslateX = transform.translateX - originX * scaleDiff / transform.scale\n    const newTranslateY = transform.translateY - originY * scaleDiff / transform.scale\n    \n    updateTransform({\n      scale: newScale,\n      translateX: newTranslateX,\n      translateY: newTranslateY\n    })\n  }, [enableZoom, transform, updateTransform])\n\n  // Double click to reset\n  const onDoubleClick = useCallback((event: React.MouseEvent<HTMLCanvasElement>) => {\n    if (resetOnDoubleClick) {\n      event.preventDefault()\n      updateTransform({\n        scale: 1,\n        translateX: 0,\n        translateY: 0\n      })\n    }\n  }, [resetOnDoubleClick, updateTransform])\n\n  // Reset transform function\n  const resetTransform = useCallback(() => {\n    updateTransform({\n      scale: 1,\n      translateX: 0,\n      translateY: 0\n    })\n  }, [updateTransform])\n\n  // Manual transform setter\n  const setTransform = useCallback((newTransform: Partial<CanvasTransform>) => {\n    updateTransform(newTransform)\n  }, [updateTransform])\n\n  // Apply transform to canvas\n  useEffect(() => {\n    if (!canvasRef.current) return\n\n    const canvas = canvasRef.current\n    const { scale, translateX, translateY } = transform\n    \n    // Apply CSS transform for hardware acceleration\n    canvas.style.transform = `translate3d(${translateX}px, ${translateY}px, 0) scale(${scale})`\n    canvas.style.transformOrigin = 'center center'\n    canvas.style.transition = isPanningRef.current || isZoomingRef.current ? 'none' : 'transform 0.1s ease-out'\n  }, [transform])\n\n  // Add native event listeners for better touch handling\n  useEffect(() => {\n    const canvas = canvasRef.current\n    if (!canvas) return\n\n    // Native event handlers that can properly preventDefault\n    const handleTouchStartNative = (e: TouchEvent) => {\n      e.preventDefault() // This works on native events\n    }\n\n    const handleTouchMoveNative = (e: TouchEvent) => {\n      e.preventDefault() // This works on native events\n    }\n\n    const handleTouchEndNative = (e: TouchEvent) => {\n      e.preventDefault() // This works on native events\n    }\n\n    // Add passive: false to ensure preventDefault works\n    canvas.addEventListener('touchstart', handleTouchStartNative, { passive: false })\n    canvas.addEventListener('touchmove', handleTouchMoveNative, { passive: false })\n    canvas.addEventListener('touchend', handleTouchEndNative, { passive: false })\n\n    return () => {\n      canvas.removeEventListener('touchstart', handleTouchStartNative)\n      canvas.removeEventListener('touchmove', handleTouchMoveNative)\n      canvas.removeEventListener('touchend', handleTouchEndNative)\n    }\n  }, [])\n\n  // Comprehensive cleanup to prevent memory leaks\n  useEffect(() => {\n    const refs = {\n      animationFrame: animationFrameRef,\n      visualFeedbackTimeout: visualFeedbackTimeoutRef,\n      lastTouches: lastTouchesRef,\n      lastDistance: lastDistanceRef,\n      isPanning: isPanningRef,\n      isZooming: isZoomingRef\n    }\n\n    return () => {\n      // Cancel any pending animation frames\n      if (refs.animationFrame.current) {\n        cancelAnimationFrame(refs.animationFrame.current)\n      }\n      \n      // Clear any pending visual feedback timeouts\n      if (refs.visualFeedbackTimeout.current) {\n        clearTimeout(refs.visualFeedbackTimeout.current)\n      }\n      \n      // Clear touch references to prevent memory leaks\n      refs.lastTouches.current = []\n      refs.lastDistance.current = 0\n      refs.isPanning.current = false\n      refs.isZooming.current = false\n    }\n  }, [])\n\n  const handlers: MobileCanvasHandlers = {\n    onTouchStart,\n    onTouchMove,\n    onTouchEnd,\n    onWheel,\n    onDoubleClick,\n    resetTransform,\n    setTransform,\n  }\n\n  return [canvasRef, transform, handlers]\n}","\nimport React, { useState, useEffect } from 'react';\nimport { Card, CardHeader, CardContent } from '../ui/card';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue\n} from '../ui/select';\nimport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from '../ui/accordion';\nimport type { YarnSpec, YarnType, YarnMaterial } from '../../types/yarn';\nimport { normalizeToTex, calculateDiameterMM, calculateThreadThicknessMM, calculateLineWeight } from '../../lib/algorithms/yarnConversion';\n\ntype YarnParametersProps = {\n  onChange: (spec: YarnSpec, calculatedLineWeight: number) => void;\n  hoopDiameterMM: number;\n  imgSizePx: number;\n  initialSpec?: YarnSpec;\n  disabled?: boolean;\n};\n\nexport const YarnParameters: React.FC<YarnParametersProps> = ({\n  onChange,\n  hoopDiameterMM,\n  imgSizePx,\n  initialSpec,\n  disabled = false\n}) => {\n  // Local state for the yarn spec\n  const [spec, setSpec] = useState<YarnSpec>(initialSpec || {\n    type: 'tex',\n    material: 'polyester',\n    tex: 30,\n    k: 1.10\n  });\n\n  // Derived values for preview\n  const tex = normalizeToTex(spec);\n  const diameterMM = calculateDiameterMM(spec);\n  const threadThicknessMM = calculateThreadThicknessMM(spec);\n  const lineWeight = calculateLineWeight(threadThicknessMM, hoopDiameterMM, imgSizePx);\n\n  // Keep reference to latest onChange to avoid effect loop\n  const onChangeRef = React.useRef(onChange);\n  useEffect(() => {\n    onChangeRef.current = onChange;\n  }, [onChange]);\n\n  // Notify parent on changes\n  useEffect(() => {\n    onChangeRef.current(spec, lineWeight);\n  }, [spec, lineWeight]);\n\n  const updateSpec = (updates: Partial<YarnSpec>) => {\n    setSpec(prev => ({ ...prev, ...updates }));\n  };\n\n  const handleTypeChange = (value: YarnType) => {\n    updateSpec({ type: value });\n  };\n\n  const handleMaterialChange = (value: YarnMaterial) => {\n    updateSpec({ material: value });\n  };\n\n  const parseNumber = (val: string) => val ? parseFloat(val) : undefined;\n\n  return (\n    <Card className=\"border-2 mt-4\">\n      <CardHeader className=\"pb-4\">\n        <h3 className=\"text-heading-sm font-semibold\">Thread / Yarn Specification</h3>\n        <p className=\"text-body-sm text-subtle\">\n          Configure based on what's printed on your spool\n        </p>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        {/* Step A: Type Selection */}\n        <div className=\"space-y-2\">\n          <label className=\"text-body-sm font-medium\">Specification Type</label>\n          <Select\n            value={spec.type}\n            onValueChange={(val) => handleTypeChange(val as YarnType)}\n            disabled={disabled}\n          >\n            <SelectTrigger>\n              <SelectValue placeholder=\"Select type\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"ticket\">Ticket / No. (e.g., 120)</SelectItem>\n              <SelectItem value=\"nm\">Nm (e.g., Nm 71/2)</SelectItem>\n              <SelectItem value=\"tex\">Tex (e.g., 30)</SelectItem>\n              <SelectItem value=\"dtex\">dtex (e.g., 141)</SelectItem>\n              <SelectItem value=\"denier\">Denier (e.g., 120)</SelectItem>\n              <SelectItem value=\"length_weight\">Length & Weight (e.g., 125m / 50g)</SelectItem>\n              <SelectItem value=\"diameter_mm\">Diameter (mm)</SelectItem>\n            </SelectContent>\n          </Select>\n        </div>\n\n        {/* Dynamic Inputs based on Type */}\n        <div className=\"grid grid-cols-2 gap-4\">\n          {spec.type === 'ticket' && (\n            <div className=\"col-span-2\">\n               <label className=\"text-caption text-subtle block mb-1\">Ticket No.</label>\n               <input\n                 type=\"number\"\n                 className=\"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\"\n                 value={spec.ticketNo || ''}\n                 onChange={(e) => updateSpec({ ticketNo: parseNumber(e.target.value) })}\n                 disabled={disabled}\n               />\n            </div>\n          )}\n\n          {spec.type === 'nm' && (\n            <>\n              <div>\n                <label className=\"text-caption text-subtle block mb-1\">Nm Value</label>\n                <input\n                  type=\"number\"\n                  className=\"w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"\n                  value={spec.nm || ''}\n                  onChange={(e) => updateSpec({ nm: parseNumber(e.target.value) })}\n                  disabled={disabled}\n                />\n              </div>\n              <div>\n                <label className=\"text-caption text-subtle block mb-1\">Ply (optional)</label>\n                <input\n                  type=\"number\"\n                  className=\"w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"\n                  value={spec.ply || ''}\n                  placeholder=\"1\"\n                  onChange={(e) => updateSpec({ ply: parseNumber(e.target.value) })}\n                  disabled={disabled}\n                />\n              </div>\n            </>\n          )}\n\n          {spec.type === 'tex' && (\n            <div className=\"col-span-2\">\n               <label className=\"text-caption text-subtle block mb-1\">Tex Value</label>\n               <input\n                 type=\"number\"\n                 className=\"w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"\n                 value={spec.tex || ''}\n                 onChange={(e) => updateSpec({ tex: parseNumber(e.target.value) })}\n                 disabled={disabled}\n               />\n            </div>\n          )}\n\n          {spec.type === 'dtex' && (\n            <>\n              <div>\n                <label className=\"text-caption text-subtle block mb-1\">dtex Value</label>\n                <input\n                  type=\"number\"\n                  className=\"w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"\n                  value={spec.dtex || ''}\n                  onChange={(e) => updateSpec({ dtex: parseNumber(e.target.value) })}\n                  disabled={disabled}\n                />\n              </div>\n              <div>\n                <label className=\"text-caption text-subtle block mb-1\">Ply (optional)</label>\n                <input\n                  type=\"number\"\n                  className=\"w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"\n                  value={spec.ply || ''}\n                  placeholder=\"1\"\n                  onChange={(e) => updateSpec({ ply: parseNumber(e.target.value) })}\n                  disabled={disabled}\n                />\n              </div>\n            </>\n          )}\n\n          {spec.type === 'denier' && (\n            <>\n              <div>\n                <label className=\"text-caption text-subtle block mb-1\">Denier Value</label>\n                <input\n                  type=\"number\"\n                  className=\"w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"\n                  value={spec.denier || ''}\n                  onChange={(e) => updateSpec({ denier: parseNumber(e.target.value) })}\n                  disabled={disabled}\n                />\n              </div>\n              <div>\n                <label className=\"text-caption text-subtle block mb-1\">Ply (optional)</label>\n                <input\n                  type=\"number\"\n                  className=\"w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"\n                  value={spec.ply || ''}\n                  placeholder=\"1\"\n                  onChange={(e) => updateSpec({ ply: parseNumber(e.target.value) })}\n                  disabled={disabled}\n                />\n              </div>\n            </>\n          )}\n\n          {spec.type === 'length_weight' && (\n            <>\n              <div>\n                <label className=\"text-caption text-subtle block mb-1\">Length (m)</label>\n                <input\n                  type=\"number\"\n                  className=\"w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"\n                  value={spec.meters || ''}\n                  onChange={(e) => updateSpec({ meters: parseNumber(e.target.value) })}\n                  disabled={disabled}\n                />\n              </div>\n              <div>\n                <label className=\"text-caption text-subtle block mb-1\">Weight (g)</label>\n                <input\n                  type=\"number\"\n                  className=\"w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"\n                  value={spec.grams || ''}\n                  onChange={(e) => updateSpec({ grams: parseNumber(e.target.value) })}\n                  disabled={disabled}\n                />\n              </div>\n            </>\n          )}\n\n          {spec.type === 'diameter_mm' && (\n            <div className=\"col-span-2\">\n               <label className=\"text-caption text-subtle block mb-1\">Diameter (mm)</label>\n               <input\n                 type=\"number\"\n                 step=\"0.01\"\n                 className=\"w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"\n                 value={spec.diameterMM || ''}\n                 onChange={(e) => updateSpec({ diameterMM: parseNumber(e.target.value) })}\n                 disabled={disabled}\n               />\n            </div>\n          )}\n        </div>\n\n        {/* Step B: Material Selection */}\n        <div className=\"space-y-2\">\n          <label className=\"text-body-sm font-medium\">Material</label>\n          <Select\n            value={spec.material}\n            onValueChange={(val) => handleMaterialChange(val as YarnMaterial)}\n            disabled={disabled}\n          >\n            <SelectTrigger>\n              <SelectValue placeholder=\"Select material\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"polyester\">Polyester (Default)</SelectItem>\n              <SelectItem value=\"cotton\">Cotton</SelectItem>\n              <SelectItem value=\"nylon\">Nylon</SelectItem>\n              <SelectItem value=\"unknown\">Unknown</SelectItem>\n            </SelectContent>\n          </Select>\n        </div>\n\n        {/* Preview Panel */}\n        <div className=\"bg-muted/50 rounded-lg p-4 space-y-2\">\n          <div className=\"flex justify-between items-center text-sm\">\n            <span className=\"text-subtle\">Normalized Tex:</span>\n            <span className=\"font-medium\">{tex.toFixed(1)}</span>\n          </div>\n          <div className=\"flex justify-between items-center text-sm\">\n            <span className=\"text-subtle\">Est. Diameter:</span>\n            <span className=\"font-medium\">{diameterMM.toFixed(3)} mm</span>\n          </div>\n          <div className=\"flex justify-between items-center text-sm\">\n             <span className=\"text-subtle\">Derived Line Weight:</span>\n             <span className=\"font-medium\">{lineWeight} / 255</span>\n          </div>\n          <div className=\"text-xs text-subtle mt-1\">\n             Frame: {hoopDiameterMM}mm, Image: {imgSizePx}px\n          </div>\n        </div>\n\n        {/* Advanced Settings */}\n        <Accordion type=\"single\" collapsible className=\"w-full\">\n          <AccordionItem value=\"yarn-advanced\">\n            <AccordionTrigger className=\"text-sm py-2\">Advanced Yarn Settings</AccordionTrigger>\n            <AccordionContent>\n              <div className=\"space-y-4 pt-2\">\n                <div>\n                   <label className=\"text-caption text-subtle block mb-1\">Visual Thickness Multiplier (k)</label>\n                   <input\n                     type=\"number\"\n                     step=\"0.01\"\n                     className=\"w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"\n                     value={spec.k || 1.10}\n                     onChange={(e) => updateSpec({ k: parseNumber(e.target.value) })}\n                     disabled={disabled}\n                   />\n                   <p className=\"text-xs text-subtle mt-1\">Adjusts effective thickness for visual density (default 1.10)</p>\n                </div>\n                <div>\n                   <label className=\"text-caption text-subtle block mb-1\">Override Diameter (mm)</label>\n                   <input\n                     type=\"number\"\n                     step=\"0.01\"\n                     className=\"w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"\n                     value={spec.overrideDiameterMM || ''}\n                     placeholder=\"Optional\"\n                     onChange={(e) => updateSpec({ overrideDiameterMM: parseNumber(e.target.value) })}\n                     disabled={disabled}\n                   />\n                </div>\n              </div>\n            </AccordionContent>\n          </AccordionItem>\n        </Accordion>\n      </CardContent>\n    </Card>\n  );\n};\n","import { useState, useRef, useEffect } from 'react'\nimport { jsPDF } from 'jspdf'\nimport { generateStringArt } from './lib/algorithms/stringArtEngine'\nimport type { StringArtResult, OptimizationProgress } from './types'\nimport { useMobileCanvas } from './hooks/useMobileCanvas'\nimport { MobileSlider } from './components/ui/mobile-slider'\nimport { YarnParameters } from './components/forms/yarn-parameters'\nimport type { YarnSpec } from './types/yarn'\n\n// Layout Components\nimport { \n  AppHeader, \n  HeroSection,\n  NavigationDots,\n  FloatingActions \n} from './components/layout'\n\n// UI Components  \nimport { Button } from './components/ui/button'\nimport { Card, CardHeader, CardContent } from './components/ui/card'\nimport { Progress } from './components/ui/progress'\nimport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from './components/ui/accordion'\nimport { CanvasErrorBoundary } from './components/ui/canvas-error-boundary'\n\n// Content Components\nimport { TutorialSection, GallerySection, FAQSection } from './components/content'\n\n\n\ninterface PresetConfig {\n  id: string\n  name: string\n  description: string\n  icon: string\n  config: {\n    numberOfPins: number\n    numberOfLines: number\n    lineWeight: number\n    imgSize: number\n  }\n}\n\nfunction App() {\n  // Core State\n  const [selectedImage, setSelectedImage] = useState<string | null>(null)\n  const [isProcessing, setIsProcessing] = useState(false)\n  const [result, setResult] = useState<StringArtResult | null>(null)\n  const [progress, setProgress] = useState<OptimizationProgress | null>(null)\n  const [error, setError] = useState<string | null>(null)\n  \n  // UI State\n  const [selectedPreset, setSelectedPreset] = useState<string>('fine')\n  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false)\n  \n  // Refs\n  const fileInputRef = useRef<HTMLInputElement>(null)\n  const animationFrameRef = useRef<number | undefined>(undefined)\n  const timeoutRef = useRef<NodeJS.Timeout | undefined>(undefined)\n  const scrollTimeoutRef = useRef<NodeJS.Timeout | undefined>(undefined)\n  \n  // Mobile canvas with pinch-to-zoom and pan functionality\n  const [mobileCanvasRef, canvasTransform, canvasHandlers] = useMobileCanvas({\n    minScale: 0.5,\n    maxScale: 4,\n    enablePan: true,\n    enableZoom: true,\n    resetOnDoubleClick: true,\n  })\n  \n  // Parameters (will be set by presets or advanced settings)\n  const [numberOfPins, setNumberOfPins] = useState(288)\n  const [numberOfLines, setNumberOfLines] = useState(4000)\n  const [lineWeight, setLineWeight] = useState(20)\n  const [imgSize, setImgSize] = useState(500)\n  const [frameDiameter, setFrameDiameter] = useState(500) // mm\n  const [yarnSpec, setYarnSpec] = useState<YarnSpec | undefined>(undefined)\n\n  // Preset configurations\n  const presets: PresetConfig[] = [\n    {\n      id: 'fine',\n      name: 'Fine Detail',\n      description: 'High precision with fine lines for detailed images',\n      icon: 'âœ¨',\n      config: { numberOfPins: 360, numberOfLines: 4000, lineWeight: 15, imgSize: 500 }\n    },\n    {\n      id: 'bold',\n      name: 'Bold Impact',\n      description: 'Strong lines and high contrast for dramatic effect',\n      icon: 'ðŸ”¥',\n      config: { numberOfPins: 216, numberOfLines: 3000, lineWeight: 35, imgSize: 500 }\n    },\n    {\n      id: 'soft',\n      name: 'Soft Portrait',\n      description: 'Gentle lines perfect for portraits and organic shapes',\n      icon: 'ðŸŒ¸',\n      config: { numberOfPins: 288, numberOfLines: 2500, lineWeight: 25, imgSize: 500 }\n    },\n    {\n      id: 'pro',\n      name: 'Professional',\n      description: 'Balanced settings optimized for exhibition quality',\n      icon: 'ðŸ‘‘',\n      config: { numberOfPins: 324, numberOfLines: 3500, lineWeight: 20, imgSize: 500 }\n    }\n  ]\n\n  // Navigation sections for smooth scrolling\n  const sections = [\n    { id: 'generator', label: 'Generator' },\n    { id: 'gallery', label: 'Gallery' },\n    { id: 'tutorial', label: 'Tutorial' },\n    { id: 'faq', label: 'FAQ' }\n  ]\n\n  // Apply preset configuration\n  const applyPreset = (presetId: string) => {\n    const preset = presets.find(p => p.id === presetId)\n    if (preset) {\n      setSelectedPreset(presetId)\n      setNumberOfPins(preset.config.numberOfPins)\n      setNumberOfLines(preset.config.numberOfLines)\n      setLineWeight(preset.config.lineWeight)\n      setImgSize(preset.config.imgSize)\n    }\n  }\n\n  // Navigation handler\n  const handleNavigation = (section: string) => {\n    const element = document.getElementById(section)\n    if (element) {\n      element.scrollIntoView({ behavior: 'smooth', block: 'start' })\n    }\n    // Close mobile menu after navigation\n    setIsMobileMenuOpen(false)\n  }\n\n  // Mobile menu toggle handler\n  const toggleMobileMenu = () => {\n    setIsMobileMenuOpen(!isMobileMenuOpen)\n  }\n\n  // Scroll to top handler\n  const handleScrollToTop = () => {\n    window.scrollTo({ top: 0, behavior: 'smooth' })\n  }\n\n  // Download handler for generated string art\n  const handleDownload = () => {\n    const canvas = mobileCanvasRef.current\n    if (!canvas) return\n\n    // Create a link element to trigger download\n    const link = document.createElement('a')\n    link.download = `string-art-${Date.now()}.png`\n    link.href = canvas.toDataURL('image/png')\n    \n    // Trigger download\n    document.body.appendChild(link)\n    link.click()\n    document.body.removeChild(link)\n  }\n\n  // Download sequence as PDF\n  const handleDownloadPDF = async () => {\n    if (!result) return\n\n    const doc = new jsPDF()\n    const margin = 20\n    let y = margin\n    const pageWidth = doc.internal.pageSize.getWidth()\n    const a4Width = 210\n    const a4Height = 297\n\n    // --- Page 1: Report & Statistics ---\n\n    // Header\n    doc.setFontSize(24)\n    doc.text('String Art Generator Report', margin, y)\n    y += 15\n\n    // Input Parameters\n    doc.setFontSize(16)\n    doc.text('Input Parameters', margin, y)\n    y += 10\n    doc.setFontSize(12)\n    doc.text(`Frame Diameter: ${frameDiameter} mm`, margin, y)\n    y += 7\n    doc.text(`Number of Pins: ${result.parameters.numberOfPins}`, margin, y)\n    y += 7\n    doc.text(`Number of Lines: ${result.parameters.numberOfLines}`, margin, y)\n    y += 7\n    doc.text(`Line Weight: ${result.parameters.lineWeight}`, margin, y)\n    y += 7\n    doc.text(`Image Size (Processing): ${result.parameters.imgSize}px`, margin, y)\n    y += 15\n\n    // Statistics\n    doc.setFontSize(16)\n    doc.text('Statistics', margin, y)\n    y += 10\n    doc.setFontSize(12)\n    doc.text(`Total Lines Drawn: ${result.lineSequence.length}`, margin, y)\n    y += 7\n    doc.text(`Total Thread Length: ${(result.totalThreadLength / 1000).toFixed(2)} meters`, margin, y)\n    y += 7\n    doc.text(`Processing Time: ${(result.processingTimeMs / 1000).toFixed(2)} seconds`, margin, y)\n    y += 15\n\n    // Note\n    doc.setFontSize(10)\n    doc.setTextColor(100)\n    doc.text('This report includes a high-resolution image, a 1:1 scale stencil/template (full & tiled), and the full pin sequence.', margin, y)\n    doc.setTextColor(0)\n\n    // --- Shared Setup for 1:1 Pages ---\n    const frameDiameterMm = result.parameters.hoopDiameter\n    const fullPageSize = frameDiameterMm + (margin * 2)\n\n    // 1. Generate High-Res Image Data (Once)\n    const canvasSize = 4000\n    const canvas = document.createElement('canvas')\n    canvas.width = canvasSize\n    canvas.height = canvasSize\n    const ctx = canvas.getContext('2d')!\n\n    // Fill white background\n    ctx.fillStyle = 'white'\n    ctx.fillRect(0, 0, canvasSize, canvasSize)\n\n    // Draw lines\n    ctx.strokeStyle = 'rgba(0, 0, 0, 0.1)'\n    ctx.lineWidth = 1.0\n    ctx.lineCap = 'round'\n    ctx.lineJoin = 'round'\n\n    const scale = canvasSize / result.parameters.imgSize\n    const pinCoords = result.pinCoordinates\n\n    for (let i = 0; i < result.lineSequence.length - 1; i++) {\n        ctx.beginPath()\n        const p1 = pinCoords[result.lineSequence[i]]\n        const p2 = pinCoords[result.lineSequence[i+1]]\n        ctx.moveTo(p1[0] * scale, p1[1] * scale)\n        ctx.lineTo(p2[0] * scale, p2[1] * scale)\n        ctx.stroke()\n    }\n    const previewImgData = canvas.toDataURL('image/jpeg', 0.8)\n\n    // 2. Helper Functions for Drawing Content\n    const drawPreviewContent = (offsetX: number, offsetY: number) => {\n        doc.setFontSize(18)\n        doc.text('Preview (1:1 Scale)', margin + offsetX, margin + offsetY)\n\n        // Image at 1:1 size\n        doc.addImage(previewImgData, 'JPEG', margin + offsetX, margin + 10 + offsetY, frameDiameterMm, frameDiameterMm)\n    }\n\n    const drawTemplateContent = (offsetX: number, offsetY: number) => {\n        doc.setFontSize(14)\n        doc.text('Template / Stencil (1:1 Scale)', margin + offsetX, margin - 5 + offsetY)\n        doc.setFontSize(10)\n        doc.text(`Diameter: ${frameDiameterMm}mm`, margin + offsetX, margin + offsetY)\n\n        const cx = (fullPageSize / 2) + offsetX\n        const cy = (fullPageSize / 2) + offsetY\n        const radius = frameDiameterMm / 2\n\n        // Main circle\n        doc.setLineWidth(0.2)\n        doc.circle(cx, cy, radius, 'S')\n\n        // Center Dot\n        doc.setFillColor(0, 0, 0)\n        doc.circle(cx, cy, 2, 'F')\n\n        // Dotted Lines\n        doc.setLineWidth(0.1)\n        doc.setLineDashPattern([2, 2], 0)\n\n        doc.line(cx - radius, cy, cx + radius, cy) // Horizontal\n        doc.line(cx, cy - radius, cx, cy + radius) // Vertical\n\n        const r45 = radius\n        const d1x = r45 * Math.cos(Math.PI / 4)\n        const d1y = r45 * Math.sin(Math.PI / 4)\n        doc.line(cx - d1x, cy - d1y, cx + d1x, cy + d1y) // Diag 1\n        doc.line(cx - d1x, cy + d1y, cx + d1x, cy - d1y) // Diag 2\n\n        doc.setLineDashPattern([], 0)\n\n        // Pins\n        const pinRadius = 0.5\n        doc.setFontSize(7)\n        const numPins = result.parameters.numberOfPins\n\n        for (let i = 0; i < numPins; i++) {\n            const pin = result.pinCoordinates[i]\n            const imgCenter = result.parameters.imgSize / 2\n\n            const dx = pin[0] - imgCenter\n            const dy = pin[1] - imgCenter\n            const angle = Math.atan2(dy, dx)\n\n            const x = cx + Math.cos(angle) * radius\n            const y = cy + Math.sin(angle) * radius\n\n            doc.setFillColor(0, 0, 0)\n            doc.circle(x, y, pinRadius, 'F')\n\n            const labelDist = 3\n            const labelX = cx + Math.cos(angle) * (radius + labelDist)\n            const labelY = cy + Math.sin(angle) * (radius + labelDist)\n\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            doc.text(i.toString(), labelX, labelY, { align: 'center', baseline: 'middle' } as any)\n        }\n    }\n\n\n    // --- Page 2: High Resolution Image (1:1 Scale - Full) ---\n    doc.addPage([fullPageSize, fullPageSize] as unknown as [number, number], fullPageSize > fullPageSize ? 'l' : 'p')\n    drawPreviewContent(0, 0)\n\n    // --- Page 2b: Tiled Preview (if larger than A4) ---\n    // Use A4 Portrait (210x297) for tiles\n    if (fullPageSize > 200) { // Slight tolerance, essentially if it doesn't fit comfortably on one page width\n        const cols = Math.ceil(fullPageSize / a4Width)\n        const rows = Math.ceil(fullPageSize / a4Height)\n\n        for (let r = 0; r < rows; r++) {\n            for (let c = 0; c < cols; c++) {\n                doc.addPage('a4', 'p')\n                // Helper text\n                doc.setFontSize(8)\n                doc.setTextColor(150)\n                doc.text(`Preview Tile: Row ${r+1}/${rows}, Col ${c+1}/${cols}`, 5, 5)\n                doc.setTextColor(0)\n\n                // Draw shifted content\n                drawPreviewContent(-c * a4Width, -r * a4Height)\n            }\n        }\n    }\n\n    // --- Page 3: Template / Stencil (1:1 Scale - Full) ---\n    doc.addPage([fullPageSize, fullPageSize] as unknown as [number, number], fullPageSize > fullPageSize ? 'l' : 'p')\n    drawTemplateContent(0, 0)\n\n    // --- Page 3b: Tiled Template (if larger than A4) ---\n    if (fullPageSize > 200) {\n        const cols = Math.ceil(fullPageSize / a4Width)\n        const rows = Math.ceil(fullPageSize / a4Height)\n\n        for (let r = 0; r < rows; r++) {\n            for (let c = 0; c < cols; c++) {\n                doc.addPage('a4', 'p')\n                doc.setFontSize(8)\n                doc.setTextColor(150)\n                doc.text(`Template Tile: Row ${r+1}/${rows}, Col ${c+1}/${cols}`, 5, 5)\n                doc.setTextColor(0)\n\n                drawTemplateContent(-c * a4Width, -r * a4Height)\n            }\n        }\n    }\n\n\n    // --- Page 4+: Pin Sequence ---\n    doc.addPage('a4', 'p')\n    y = margin\n    doc.setFontSize(18)\n    doc.text('Pin Sequence', margin, y)\n    y += 10\n\n    // 4 columns as requested by reviewer\n    doc.setFontSize(9)\n    const cols = 4\n    const colWidth = (pageWidth - (margin * 2)) / cols\n    const rowsPerColumn = Math.floor((doc.internal.pageSize.getHeight() - y - margin) / 5) // 5mm per row\n\n    let currentStep = 0\n    const sequence = result.lineSequence\n    const totalSteps = sequence.length - 1\n\n    while (currentStep < totalSteps) {\n        // Draw columns\n        for (let col = 0; col < cols; col++) {\n            const xBase = margin + (col * colWidth)\n\n            for (let row = 0; row < rowsPerColumn; row++) {\n                if (currentStep >= totalSteps) break\n\n                const fromPin = sequence[currentStep]\n                const toPin = sequence[currentStep + 1]\n                const stepNumber = currentStep + 1\n\n                // Format: 1) 0 -> 116\n                doc.text(`${stepNumber}) ${fromPin} -> ${toPin}`, xBase, y + (row * 5))\n\n                currentStep++\n            }\n        }\n\n        if (currentStep < totalSteps) {\n            doc.addPage()\n            y = margin // Reset y for new page\n        }\n    }\n\n    doc.save(`string-art-plan-${frameDiameter}mm-${Date.now()}.pdf`)\n  }\n\n  // Download template as PNG image\n  const handleDownloadTemplateImage = () => {\n    if (!result) return\n\n    // Create high-res canvas for the template\n    const canvasSize = 4000 // High res for printing\n    const canvas = document.createElement('canvas')\n    canvas.width = canvasSize\n    canvas.height = canvasSize\n    const ctx = canvas.getContext('2d')!\n\n    // Fill white background\n    ctx.fillStyle = 'white'\n    ctx.fillRect(0, 0, canvasSize, canvasSize)\n\n    // Draw center and circle\n    const cx = canvasSize / 2\n    const cy = canvasSize / 2\n\n    // Leave some padding\n    const padding = 100\n    const radius = (canvasSize - 2 * padding) / 2\n\n    // Draw main circle\n    ctx.strokeStyle = 'black'\n    ctx.lineWidth = 2\n    ctx.beginPath()\n    ctx.arc(cx, cy, radius, 0, 2 * Math.PI)\n    ctx.stroke()\n\n    // Draw Center Dot\n    ctx.fillStyle = 'black'\n    ctx.beginPath()\n    ctx.arc(cx, cy, 20, 0, 2 * Math.PI)\n    ctx.fill()\n\n    // Draw 4 Dotted Lines\n    ctx.strokeStyle = 'black'\n    ctx.lineWidth = 2 // Scaled line width (same as circle)\n    ctx.setLineDash([20, 20]) // Scaled dash pattern\n\n    // 1. Horizontal\n    ctx.beginPath()\n    ctx.moveTo(cx - radius, cy)\n    ctx.lineTo(cx + radius, cy)\n    ctx.stroke()\n\n    // 2. Vertical\n    ctx.beginPath()\n    ctx.moveTo(cx, cy - radius)\n    ctx.lineTo(cx, cy + radius)\n    ctx.stroke()\n\n    // 3. Diagonal 1\n    const d1x = radius * Math.cos(Math.PI / 4)\n    const d1y = radius * Math.sin(Math.PI / 4)\n    ctx.beginPath()\n    ctx.moveTo(cx - d1x, cy - d1y)\n    ctx.lineTo(cx + d1x, cy + d1y)\n    ctx.stroke()\n\n    // 4. Diagonal 2\n    ctx.beginPath()\n    ctx.moveTo(cx - d1x, cy + d1y)\n    ctx.lineTo(cx + d1x, cy - d1y)\n    ctx.stroke()\n\n    ctx.setLineDash([]) // Reset\n\n    // Draw pins\n    const pinRadius = 4\n    ctx.fillStyle = 'black'\n    ctx.textAlign = 'center'\n    ctx.textBaseline = 'middle'\n\n    // Adjust font size based on number of pins to prevent overlap\n    // For 4000px canvas, we want readable numbers.\n    // Circumference = PI * diameter approx 3800 * PI = 12000px.\n    // 12000 / numPins (e.g. 300) = 40px spacing.\n    // Font size should be smaller than spacing.\n    const numPins = result.parameters.numberOfPins\n    // Calculate available arc length per pin\n    const circumference = Math.PI * (radius * 2)\n    const arcPerPin = circumference / numPins\n    // Set font size to 60% of available space, but clamped between 24 and 80\n    const fontSize = Math.max(24, Math.min(80, Math.floor(arcPerPin * 0.6)))\n    ctx.font = `${fontSize}px Arial`\n\n    const labelDist = 40 // distance for numbers\n\n    for (let i = 0; i < numPins; i++) {\n        const pin = result.pinCoordinates[i]\n        const imgCenter = result.parameters.imgSize / 2\n\n        const dx = pin[0] - imgCenter\n        const dy = pin[1] - imgCenter\n        const angle = Math.atan2(dy, dx)\n\n        // Place exactly on radius\n        const x = cx + Math.cos(angle) * radius\n        const y = cy + Math.sin(angle) * radius\n\n        // Draw pin dot\n        ctx.beginPath()\n        ctx.arc(x, y, pinRadius, 0, 2 * Math.PI)\n        ctx.fill()\n\n        // Draw pin number\n        // Rotate text to align with radius for better readability?\n        // Or just place outside. Placing outside is standard.\n        const labelX = cx + Math.cos(angle) * (radius + labelDist)\n        const labelY = cy + Math.sin(angle) * (radius + labelDist)\n\n        // Optional: Rotate context for number\n        ctx.save()\n        ctx.translate(labelX, labelY)\n        ctx.rotate(angle + Math.PI / 2) // Rotate to be perpendicular to radius? Or aligned?\n        // Let's keep it simple: just draw text at location, maybe rotated if crowded.\n        // For now, simple text.\n        ctx.restore()\n\n        ctx.fillText(i.toString(), labelX, labelY)\n    }\n\n    // Download\n    const link = document.createElement('a')\n    link.download = `string-art-template-${Date.now()}.png`\n    link.href = canvas.toDataURL('image/png')\n    document.body.appendChild(link)\n    link.click()\n    document.body.removeChild(link)\n  }\n\n  // Download sequence as TXT\n  const handleDownloadTXT = () => {\n    if (!result) return\n\n    const content = `String Art Pin Sequence\nTotal Pins: ${result.parameters.numberOfPins}\nTotal Lines: ${result.lineSequence.length}\nThread Length: ${result.totalThreadLength.toFixed(2)} inches\n\nPin Sequence:\n${result.lineSequence.join(', ')}`\n\n    const blob = new Blob([content], { type: 'text/plain' })\n    const link = document.createElement('a')\n    link.download = `string-art-sequence-${Date.now()}.txt`\n    link.href = URL.createObjectURL(blob)\n\n    document.body.appendChild(link)\n    link.click()\n    document.body.removeChild(link)\n    URL.revokeObjectURL(link.href)\n  }\n\n  // Try Again handler - reset everything and go back to generator\n  const handleTryAgain = () => {\n    // Cancel any pending operations first\n    if (animationFrameRef.current) {\n      cancelAnimationFrame(animationFrameRef.current)\n      animationFrameRef.current = undefined\n    }\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current)\n      timeoutRef.current = undefined\n    }\n    if (scrollTimeoutRef.current) {\n      clearTimeout(scrollTimeoutRef.current)\n      scrollTimeoutRef.current = undefined\n    }\n    \n    // Reset all states\n    setSelectedImage(null)\n    setResult(null)\n    setProgress(null)\n    setError(null)\n    setIsProcessing(false)\n    \n    // Reset file input\n    if (fileInputRef.current) {\n      fileInputRef.current.value = ''\n    }\n    \n    // Navigate to generator section\n    handleNavigation('generator')\n  }\n\n  // Remove HTML loading overlay once React has mounted\n  useEffect(() => {\n    const removeLoadingOverlay = () => {\n      const overlay = document.getElementById('loading-overlay')\n      if (overlay) {\n        overlay.classList.add('hide')\n        // Remove completely after animation\n        setTimeout(() => {\n          overlay.remove()\n        }, 300)\n      }\n    }\n\n    // Small delay to ensure smooth transition\n    const timer = setTimeout(removeLoadingOverlay, 100)\n    return () => clearTimeout(timer)\n  }, [])\n\n  // Cleanup effect to prevent memory leaks\n  useEffect(() => {\n    return () => {\n      // Cancel any pending animation frames\n      if (animationFrameRef.current) {\n        cancelAnimationFrame(animationFrameRef.current)\n      }\n      \n      // Clear any pending timeouts\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current)\n      }\n      \n      // Clear scroll timeout\n      if (scrollTimeoutRef.current) {\n        clearTimeout(scrollTimeoutRef.current)\n      }\n    }\n  }, [])\n\n\n  // Enhanced drag & drop state for mobile\n  const [isDragOver, setIsDragOver] = useState(false)\n\n  const processFile = (file: File) => {\n    // Check file size (warn if > 5MB)\n    if (file.size > 5 * 1024 * 1024) {\n      // Large image detected - no alert needed\n    }\n\n    const reader = new FileReader()\n    reader.onload = (e) => {\n      setSelectedImage(e.target?.result as string)\n      setResult(null)\n      setError(null)\n    }\n    reader.readAsDataURL(file)\n  }\n\n  const handleImageUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0]\n    if (!file) return\n    processFile(file)\n  }\n\n  // Enhanced drag & drop handlers for mobile and desktop\n  const handleDragOver = (e: React.DragEvent) => {\n    e.preventDefault()\n    setIsDragOver(true)\n  }\n\n  const handleDragLeave = (e: React.DragEvent) => {\n    e.preventDefault()\n    setIsDragOver(false)\n  }\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault()\n    setIsDragOver(false)\n    \n    const files = Array.from(e.dataTransfer.files)\n    const imageFile = files.find(file => file.type.startsWith('image/'))\n    \n    if (imageFile) {\n      processFile(imageFile)\n    } else {\n      // Invalid file type - no alert needed\n    }\n  }\n\n  const generateArt = async () => {\n    if (!selectedImage) return\n\n    // Cancel any pending operations before starting new generation\n    if (animationFrameRef.current) {\n      cancelAnimationFrame(animationFrameRef.current)\n      animationFrameRef.current = undefined\n    }\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current)\n      timeoutRef.current = undefined\n    }\n\n    setIsProcessing(true)\n    setError(null)\n    setProgress(null)\n\n    // Auto-scroll to the result section so user can see the generation progress\n    // Clear any existing scroll timeout\n    if (scrollTimeoutRef.current) {\n      clearTimeout(scrollTimeoutRef.current)\n    }\n    \n    scrollTimeoutRef.current = setTimeout(() => {\n      const resultSection = document.getElementById('string-art-result')\n      if (resultSection) {\n        resultSection.scrollIntoView({ \n          behavior: 'smooth', \n          block: 'start' \n        })\n      }\n      scrollTimeoutRef.current = undefined\n    }, 100) // Small delay to ensure the canvas is rendered\n\n    try {\n      const img = new Image()\n      img.onload = async () => {\n        try {\n          const stringArtResult = await generateStringArt(\n            img,\n            {\n              numberOfPins,\n              numberOfLines,\n              lineWeight,\n              minDistance: Math.max(2, Math.floor(numberOfPins / 36)),\n              imgSize,\n              hoopDiameter: frameDiameter,\n            },\n            (progressUpdate, currentLineSequence, pinCoordinates) => {\n              setProgress(progressUpdate)\n              \n              if (currentLineSequence && pinCoordinates) {\n                // Cancel any existing animation frame before scheduling new one\n                if (animationFrameRef.current) {\n                  cancelAnimationFrame(animationFrameRef.current)\n                }\n                \n                animationFrameRef.current = requestAnimationFrame(() => {\n                  drawProgressiveLines(currentLineSequence, pinCoordinates, imgSize, progressUpdate.linesDrawn)\n                  animationFrameRef.current = undefined\n                })\n              }\n            }\n          )\n\n          setResult(stringArtResult)\n        } catch (error) {\n          console.error('Generation failed:', error)\n          const errorMessage = error instanceof Error ? error.message : 'Unknown error occurred'\n          setError(errorMessage)\n        } finally {\n          setIsProcessing(false)\n        }\n      }\n      img.src = selectedImage\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Failed to process image'\n      setError(errorMessage)\n      setIsProcessing(false)\n    }\n  }\n\n  // Enhanced mobile canvas interaction with visual feedback\n  const handleCanvasInteraction = (e: React.TouchEvent<HTMLCanvasElement>) => {\n    // The useMobileCanvas hook handles all touch interactions\n    // Just add visual feedback for touch recognition\n    const canvas = e.currentTarget\n    canvas.style.filter = 'brightness(0.95)'\n    \n    // Clear any existing timeout to prevent leaks\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current)\n    }\n    \n    timeoutRef.current = setTimeout(() => {\n      canvas.style.filter = 'brightness(1)'\n      timeoutRef.current = undefined\n    }, 150)\n  }\n\n  // Progressive drawing function with mobile canvas support\n  const drawProgressiveLines = (lineSequence: number[], pinCoordinates: [number, number][], currentImgSize: number, upToLineIndex: number) => {\n    const canvas = mobileCanvasRef.current\n    if (!canvas || !lineSequence || !pinCoordinates) return\n\n    const ctx = canvas.getContext('2d')!\n    \n    // Store the current transform to reset it for drawing\n    const currentTransform = canvasTransform\n    canvas.style.transform = 'none'\n    \n    canvas.width = 600\n    canvas.height = 600\n    const scale = canvas.width / currentImgSize\n\n    // Clear and redraw\n    ctx.fillStyle = 'white'\n    ctx.fillRect(0, 0, canvas.width, canvas.height)\n\n    const center = canvas.width / 2\n\n    // Circle boundary\n    ctx.strokeStyle = '#e5e7eb' // Light gray border\n    ctx.lineWidth = 1\n    ctx.beginPath()\n    ctx.arc(center, center, (canvas.width / 2) - 5, 0, Math.PI * 2)\n    ctx.stroke()\n\n    // Draw lines\n    ctx.strokeStyle = 'rgba(0, 0, 0, 0.15)' // Semi-transparent black lines\n    ctx.lineWidth = 1.0\n    ctx.lineCap = 'round'\n    ctx.lineJoin = 'round'\n    \n    const linesToDraw = Math.min(upToLineIndex, lineSequence.length - 1)\n    \n    for (let i = 0; i < linesToDraw; i++) {\n      const pin1Index = lineSequence[i]\n      const pin2Index = lineSequence[i + 1]\n      const pin1 = pinCoordinates[pin1Index]\n      const pin2 = pinCoordinates[pin2Index]\n      \n      if (pin1 && pin2 && pin1[0] !== undefined && pin1[1] !== undefined) {\n        ctx.beginPath()\n        ctx.moveTo(pin1[0] * scale, pin1[1] * scale)\n        ctx.lineTo(pin2[0] * scale, pin2[1] * scale)\n        ctx.stroke()\n      }\n    }\n\n    // Draw pins\n    ctx.fillStyle = 'rgba(34, 139, 230, 0.6)' // Semi-transparent blue pins\n    pinCoordinates.forEach(([x, y]) => {\n      if (x !== undefined && y !== undefined) {\n        ctx.beginPath()\n        ctx.arc(x * scale, y * scale, 1.5, 0, Math.PI * 2)\n        ctx.fill()\n      }\n    })\n    \n    // Restore the transform after drawing\n    // Clear any existing animation frame to prevent leaks\n    if (animationFrameRef.current) {\n      cancelAnimationFrame(animationFrameRef.current)\n    }\n    \n    animationFrameRef.current = requestAnimationFrame(() => {\n      canvas.style.transform = `translate3d(${currentTransform.translateX}px, ${currentTransform.translateY}px, 0) scale(${currentTransform.scale})`\n      animationFrameRef.current = undefined\n    })\n  }\n\n\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header */}\n      <AppHeader \n        onNavigate={handleNavigation}\n        onToggleMobileMenu={toggleMobileMenu}\n        isMobileMenuOpen={isMobileMenuOpen}\n      />\n\n      {/* Navigation Dots */}\n      <NavigationDots sections={sections} />\n\n\n\n      {/* SEO Content - Hidden but crawlable */}\n      <div className=\"sr-only\">\n        <h2>Mathematical String Art Generator Tool</h2>\n        <p>Our advanced string art generator uses mathematical algorithms to convert photos into string art patterns. Perfect for creating mathematical art, educational demonstrations, and DIY crafts. Features include:</p>\n        <ul>\n          <li>Convert photo to string art using algorithmic optimization</li>\n          <li>Mathematical string art with precise calculations</li>\n          <li>Educational tool for art and mathematics intersection</li>\n          <li>DIY string art patterns for physical creation</li>\n          <li>Customizable pins, lines, and artistic presets</li>\n          <li>Real-time generation with progress tracking</li>\n        </ul>\n        <h3>How String Art Algorithms Work</h3>\n        <p>String art generation involves complex mathematical optimization to determine optimal line sequences between pins that recreate image patterns using thread connections.</p>\n      </div>\n\n      {/* Main Content */}\n      <main>\n        {/* Hero Section */}\n        <HeroSection id=\"generator\">\n          <div className=\"text-center space-y-6 sm:space-y-8\">\n            <div className=\"space-y-4\">\n              <h1 className=\"text-display-md sm:text-display-lg lg:text-display-xl font-extrabold tracking-tight px-4 bg-gradient-to-b from-foreground to-foreground/80 bg-clip-text text-transparent\">\n                String Art Generator - Convert Photos to Mathematical String Art\n              </h1>\n              <p className=\"text-body-lg sm:text-heading-sm text-muted-foreground max-w-3xl mx-auto px-4 leading-relaxed\">\n                Transform your photos into beautiful mathematical string art using advanced algorithms and customizable presets. Perfect for educators, artists, and DIY enthusiasts.\n              </p>\n            </div>\n            <div className=\"text-caption text-brand font-medium px-4\">\n              AI-Powered â€¢ Mathematical Precision â€¢ Exhibition Quality\n            </div>\n          </div>\n        </HeroSection>\n\n        {/* Generator Section */}\n        <div className=\"w-full scroll-mt-16 py-8 md:py-12 lg:py-16\">\n          <div className=\"container-apple\">\n            <div className=\"space-y-8 sm:space-y-10 lg:space-y-12\">\n          {/* Image Upload Area */}\n          <Card className=\"card-hover border-2\">\n            <CardHeader className=\"pb-6\">\n              <h2 className=\"text-heading-lg font-semibold\">Upload Your Image</h2>\n              <p className=\"text-body-sm text-subtle mt-2\">\n                Choose a high-contrast photo for the best string art results. JPG, PNG, and WebP formats are supported.\n              </p>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                {/* Enhanced Mobile Drag & Drop Upload Area */}\n                <div \n                  className={`\n                    drag-zone-mobile text-center transition-all cursor-pointer\n                    min-h-[220px] sm:min-h-[240px] flex flex-col items-center justify-center\n                    touch-feedback-gentle focus-mobile\n                    ${selectedImage \n                      ? 'border-primary bg-primary/5' \n                      : isDragOver \n                        ? 'drag-active'\n                        : 'border-border hover:border-primary/50 hover:bg-accent/50'\n                    }\n                  `}\n                  onClick={() => fileInputRef.current?.click()}\n                  onDragOver={handleDragOver}\n                  onDragLeave={handleDragLeave}\n                  onDrop={handleDrop}\n                  role=\"button\"\n                  tabIndex={0}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter' || e.key === ' ') {\n                      fileInputRef.current?.click()\n                    }\n                  }}\n                >\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handleImageUpload}\n                    className=\"hidden\"\n                  />\n                  \n                  {selectedImage ? (\n                    <div className=\"space-y-3 sm:space-y-4\">\n                      <img \n                        src={selectedImage} \n                        alt=\"Selected\" \n                        className=\"max-w-full h-auto mx-auto max-h-48 sm:max-h-64 object-contain rounded-lg shadow-sm\"\n                      />\n                      <p className=\"text-body-sm text-subtle\">\n                        Tap to change image\n                      </p>\n                    </div>\n                  ) : (\n                    <div className=\"space-y-3 sm:space-y-4\">\n                      <div className={`text-5xl sm:text-6xl transition-transform ${isDragOver ? 'scale-110' : ''}`}>\n                        {isDragOver ? 'ðŸŽ¯' : 'ðŸ“¸'}\n                      </div>\n                      <div className=\"space-y-2\">\n                        <p className=\"text-heading-sm font-medium\">\n                          {isDragOver ? 'Drop your image here!' : 'Drop your image here'}\n                        </p>\n                        <p className=\"text-body-sm text-subtle px-4\">\n                          {isDragOver \n                            ? 'Release to upload your image' \n                            : 'or tap to browse files'\n                          }\n                        </p>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Preset Selection */}\n          <div className={!selectedImage ? \"opacity-50\" : \"\"}>\n            {/* Preset Selection */}\n            <Card className=\"card-hover border-2\">\n              <CardHeader className=\"pb-6\">\n                <h2 className=\"text-heading-lg font-semibold\">Choose Style Preset</h2>\n                <p className=\"text-body-sm text-subtle mt-2\">\n                  Each preset is optimized for different image types and artistic styles. Fine-tune with advanced settings if needed.\n                </p>\n              </CardHeader>\n              <CardContent>\n                <div className=\"mobile-grid-auto\">\n                  {presets.map((preset) => (\n                    <Card \n                      key={preset.id}\n                      className={`cursor-pointer transition-all touch-feedback focus-mobile ${\n                        selectedPreset === preset.id \n                          ? 'ring-2 ring-primary bg-primary/5' \n                          : 'hover:shadow-md card-hover'\n                      }`}\n                      onClick={() => applyPreset(preset.id)}\n                      role=\"button\"\n                      tabIndex={0}\n                      onKeyDown={(e) => {\n                        if (e.key === 'Enter' || e.key === ' ') {\n                          applyPreset(preset.id)\n                        }\n                      }}\n                    >\n                      <CardContent className=\"mobile-spacing-lg text-center min-h-[160px] sm:min-h-[180px] flex flex-col justify-center touch-target\">\n                        <div className=\"text-4xl sm:text-5xl mb-3 sm:mb-4\">{preset.icon}</div>\n                        <h3 className=\"text-heading-sm font-semibold mb-2\">{preset.name}</h3>\n                        <p className=\"text-body-sm text-subtle leading-relaxed\">\n                          {preset.description}\n                        </p>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n                \n                {/* Advanced Settings Accordion */}\n                <div className=\"mt-8 pt-8 border-t border-border\">\n                  <Accordion type=\"single\" collapsible>\n                    <AccordionItem value=\"advanced-settings\">\n                      <AccordionTrigger className=\"hover:no-underline text-heading-sm font-medium\">\n                        Advanced Settings\n                      </AccordionTrigger>\n                      <AccordionContent>\n                        <div className=\"space-y-6 pt-4\">\n                          <div className=\"mobile-stack\">\n                            <MobileSlider\n                              label=\"Number of Pins\"\n                              min={36}\n                              max={360}\n                              step={36}\n                              value={numberOfPins}\n                              onValueChange={setNumberOfPins}\n                              disabled={isProcessing}\n                              formatValue={(val) => `${val} pins`}\n                              className=\"w-full\"\n                            />\n                            <div className=\"text-body-sm text-subtle mt-2 leading-relaxed\">\n                              More pins create finer detail but increase processing time.\n                            </div>\n                            \n                            <MobileSlider\n                              label=\"Number of Lines\"\n                              min={100}\n                              max={4000}\n                              step={100}\n                              value={numberOfLines}\n                              onValueChange={setNumberOfLines}\n                              disabled={isProcessing}\n                              formatValue={(val) => `${val} lines`}\n                              className=\"w-full\"\n                            />\n                            <div className=\"text-body-sm text-subtle mt-2 leading-relaxed\">\n                              More lines create darker, richer results.\n                            </div>\n                            \n                            <YarnParameters\n                              onChange={(spec, weight) => {\n                                setYarnSpec(spec);\n                                setLineWeight(weight);\n                              }}\n                              hoopDiameterMM={frameDiameter}\n                              imgSizePx={imgSize}\n                              initialSpec={yarnSpec}\n                              disabled={isProcessing}\n                            />\n                            \n                            <MobileSlider\n                              label=\"Canvas Size\"\n                              min={200}\n                              max={600}\n                              step={50}\n                              value={imgSize}\n                              onValueChange={setImgSize}\n                              disabled={isProcessing}\n                              formatValue={(val) => `${val}px`}\n                              className=\"w-full\"\n                            />\n                            <div className=\"text-body-sm text-subtle mt-2 leading-relaxed\">\n                              Higher resolution improves quality but takes longer.\n                            </div>\n\n                            <MobileSlider\n                              label=\"Frame Diameter\"\n                              min={200}\n                              max={1000}\n                              step={10}\n                              value={frameDiameter}\n                              onValueChange={setFrameDiameter}\n                              disabled={isProcessing}\n                              formatValue={(val) => `${val}mm`}\n                              className=\"w-full\"\n                            />\n                            <div className=\"text-body-sm text-subtle mt-2 leading-relaxed\">\n                              Physical size of the frame. Used for thread length calculation and template generation.\n                            </div>\n                          </div>\n                          \n                          <div className=\"bg-muted/50 rounded-lg p-6\">\n                            <h4 className=\"text-heading-sm font-medium mb-3 text-brand\">ðŸ’¡ Pro Tips</h4>\n                            <ul className=\"text-body-sm text-subtle space-y-2\">\n                              <li>â€¢ Use high contrast images for better definition</li>\n                              <li>â€¢ Portrait photos work best with 288+ pins</li>\n                              <li>â€¢ Start with presets, then fine-tune if needed</li>\n                              <li>â€¢ Large settings may take 30+ seconds to process</li>\n                            </ul>\n                          </div>\n                        </div>\n                      </AccordionContent>\n                    </AccordionItem>\n                  </Accordion>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Enhanced Mobile Generate Button */}\n          <Button\n              onClick={generateArt}\n              disabled={!selectedImage || isProcessing}\n              size=\"lg\"\n              className=\"w-full touch-target-xl text-heading-sm font-semibold min-h-[72px] sm:min-h-[80px] touch-feedback shadow-lg hover:shadow-xl focus-mobile\"\n            >\n              {isProcessing ? (\n                <div className=\"flex items-center gap-2\">\n                  <div className=\"w-4 h-4 border-2 border-primary-foreground/30 border-t-primary-foreground rounded-full animate-spin\" />\n                  Generating...\n                </div>\n              ) : (\n                'Generate String Art'\n              )}\n            </Button>\n\n\n\n          {/* Error Display */}\n          {error && (\n            <Card className=\"border-destructive bg-destructive/5 border-2\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-start space-x-3\">\n                  <div className=\"text-2xl\">âš ï¸</div>\n                  <div>\n                    <h4 className=\"text-heading-sm font-medium text-destructive mb-2\">Generation Error</h4>\n                    <p className=\"text-body-sm text-destructive/80\">{error}</p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Canvas Results */}\n          {(progress || result) && (\n            <Card id=\"string-art-result\" className=\"card-hover border-2 scroll-mt-20\">\n              <CardHeader className=\"pb-6\">\n                <h2 className=\"text-heading-lg font-semibold\">String Art Result</h2>\n                <p className=\"text-body-sm text-subtle mt-2\">\n                  Your generated string art with mathematical precision and artistic beauty.\n                </p>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  <div className=\"relative w-full max-w-lg mx-auto\">\n                    <CanvasErrorBoundary onReset={handleTryAgain}>\n                      <canvas\n                        ref={mobileCanvasRef}\n                        className=\"canvas-zoomable border border-border rounded-lg w-full mx-auto block transition-transform duration-100 touch-optimized\"\n                        style={{ aspectRatio: '1/1', touchAction: 'none' }}\n                        onTouchStart={(e) => {\n                          handleCanvasInteraction(e)\n                          canvasHandlers.onTouchStart(e)\n                        }}\n                        onTouchMove={canvasHandlers.onTouchMove}\n                        onTouchEnd={(e) => {\n                          canvasHandlers.onTouchEnd(e)\n                        }}\n                        onWheel={canvasHandlers.onWheel}\n                        onDoubleClick={canvasHandlers.onDoubleClick}\n                      />\n                    </CanvasErrorBoundary>\n                    \n                    {/* Mobile zoom controls overlay */}\n                    <div className=\"absolute top-2 right-2 flex flex-col gap-1 sm:hidden\">\n                      <button\n                        onClick={() => canvasHandlers.setTransform({ scale: Math.min(4, canvasTransform.scale * 1.2) })}\n                        className=\"touch-target bg-background/90 backdrop-blur-sm border border-border/50 rounded-lg shadow-lg text-xs font-medium\"\n                        disabled={canvasTransform.scale >= 4}\n                        aria-label=\"Zoom in\"\n                      >\n                        +\n                      </button>\n                      <button\n                        onClick={() => canvasHandlers.setTransform({ scale: Math.max(0.5, canvasTransform.scale * 0.8) })}\n                        className=\"touch-target bg-background/90 backdrop-blur-sm border border-border/50 rounded-lg shadow-lg text-xs font-medium\"\n                        disabled={canvasTransform.scale <= 0.5}\n                        aria-label=\"Zoom out\"\n                      >\n                        -\n                      </button>\n                      <button\n                        onClick={canvasHandlers.resetTransform}\n                        className=\"touch-target bg-background/90 backdrop-blur-sm border border-border/50 rounded-lg shadow-lg text-xs font-medium\"\n                        aria-label=\"Reset zoom\"\n                      >\n                        âŒ‚\n                      </button>\n                    </div>\n                    \n                    {/* Mobile interaction hint */}\n                    {canvasTransform.scale === 1 && canvasTransform.translateX === 0 && canvasTransform.translateY === 0 && (\n                      <div className=\"absolute bottom-2 left-1/2 transform -translate-x-1/2 bg-background/90 backdrop-blur-sm px-3 py-1 rounded-full text-xs text-subtle border border-border/50 sm:hidden\">\n                        Pinch to zoom â€¢ Double tap to reset\n                      </div>\n                    )}\n                  </div>\n                  \n                  {/* Progress Display - Moved between canvas and details */}\n                  {progress && (\n                    <Card className=\"glass-effect border-2\">\n                      <CardContent className=\"p-8\">\n                        <div className=\"space-y-6\">\n                          <div className=\"flex justify-between items-center\">\n                            <h3 className=\"text-heading-md font-semibold\">Generating Your String Art</h3>\n                            <span className=\"text-heading-sm font-medium text-brand\">\n                              {progress.percentComplete.toFixed(1)}%\n                            </span>\n                          </div>\n                          \n                          <Progress value={progress.percentComplete} className=\"w-full\" />\n                          \n                          <div className=\"grid grid-cols-2 gap-6 text-body-sm text-subtle\">\n                            <div className=\"space-y-1\">\n                              <div className=\"text-caption text-emphasis\">LINES DRAWN</div>\n                              <div className=\"font-medium\">{progress.linesDrawn} / {progress.totalLines}</div>\n                            </div>\n                            <div className=\"space-y-1\">\n                              <div className=\"text-caption text-emphasis\">THREAD LENGTH</div>\n                              <div className=\"font-medium\">{(progress.threadLength / 1000).toFixed(2)}m</div>\n                            </div>\n                          </div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  )}\n                  \n                  {result && (\n                    <div className=\"bg-muted/50 rounded-lg p-6 space-y-4\">\n                      <h4 className=\"text-heading-sm font-medium text-emphasis mb-4\">Generation Details</h4>\n                      <div className=\"grid grid-cols-2 gap-4\">\n                        <div className=\"space-y-1\">\n                          <div className=\"text-caption text-emphasis\">PROCESSING TIME</div>\n                          <div className=\"text-body-sm font-medium\">{(result.processingTimeMs / 1000).toFixed(1)}s</div>\n                        </div>\n                        <div className=\"space-y-1\">\n                          <div className=\"text-caption text-emphasis\">TOTAL LINES</div>\n                          <div className=\"text-body-sm font-medium\">{result.lineSequence.length}</div>\n                        </div>\n                        <div className=\"space-y-1\">\n                          <div className=\"text-caption text-emphasis\">THREAD LENGTH</div>\n                          <div className=\"text-body-sm font-medium\">{(result.totalThreadLength / 1000).toFixed(2)}m</div>\n                        </div>\n                        <div className=\"space-y-1\">\n                          <div className=\"text-caption text-emphasis\">ANCHOR PINS</div>\n                          <div className=\"text-body-sm font-medium\">{result.parameters.numberOfPins}</div>\n                        </div>\n                      </div>\n                      \n                      <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 pt-6\">\n                        <Button \n                          variant=\"outline\" \n                          className=\"touch-target-lg text-body-sm font-medium touch-feedback focus-mobile\"\n                          onClick={handleDownload}\n                        >\n                          <span className=\"mr-2\">ðŸ“¥</span>\n                          Download PNG\n                        </Button>\n                        <Button \n                          variant=\"outline\" \n                          className=\"touch-target-lg text-body-sm font-medium touch-feedback focus-mobile\"\n                          onClick={handleDownloadPDF}\n                        >\n                          <span className=\"mr-2\">ðŸ“„</span>\n                          Download PDF\n                        </Button>\n                        <Button\n                          variant=\"outline\"\n                          className=\"touch-target-lg text-body-sm font-medium touch-feedback focus-mobile\"\n                          onClick={handleDownloadTemplateImage}\n                        >\n                          <span className=\"mr-2\">ðŸŽ¯</span>\n                          Download Template\n                        </Button>\n                        <Button\n                          variant=\"outline\"\n                          className=\"touch-target-lg text-body-sm font-medium touch-feedback focus-mobile\"\n                          onClick={handleDownloadTXT}\n                        >\n                          <span className=\"mr-2\">ðŸ“</span>\n                          Download TXT\n                        </Button>\n                        <Button\n                          variant=\"outline\"\n                          className=\"touch-target-lg text-body-sm font-medium touch-feedback focus-mobile\"\n                          onClick={handleTryAgain}\n                        >\n                          <span className=\"mr-2\">ðŸ”„</span>\n                          Create New\n                        </Button>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n            </div>\n          </div>\n        </div>\n\n        {/* Visual Separator */}\n        <div className=\"w-full py-8\">\n          <div className=\"container-apple\">\n            <div className=\"h-px bg-gradient-to-r from-transparent via-border to-transparent\"></div>\n          </div>\n        </div>\n\n\n        {/* Gallery Section */}\n        <GallerySection />\n\n        {/* Tutorial Section */}\n        <TutorialSection />\n\n        {/* FAQ Section */}\n        <FAQSection />\n      </main>\n\n      {/* Floating Actions */}\n      <FloatingActions \n        onScrollToTop={handleScrollToTop}\n        onShowHelp={() => handleNavigation('faq')}\n      />\n\n    </div>\n  )\n}\n\nexport default App","import { StrictMode } from 'react'\nimport { createRoot } from 'react-dom/client'\nimport './index.css'\nimport App from './App.tsx'\n\ncreateRoot(document.getElementById('root')!).render(\n  <StrictMode>\n    <App />\n  </StrictMode>,\n)\n"],"names":["useMobileCanvas","options","minScale","maxScale","enablePan","enableZoom","resetOnDoubleClick","canvasRef","useRef","transform","setTransformState","useState","lastTouchesRef","lastDistanceRef","isPanningRef","isZoomingRef","animationFrameRef","visualFeedbackTimeoutRef","getTouchDistance","useCallback","touch1","touch2","dx","dy","getTouchCenter","constrainScale","scale","constrainPan","translateX","translateY","rect","scaledWidth","scaledHeight","maxTranslateX","maxTranslateY","updateTransform","newTransform","current","updated","constrainedPan","onTouchStart","event","touches","canvas","onTouchMove","lastTouches","touch","lastTouch","deltaX","deltaY","currentDistance","lastDistance","scaleChange","newScale","center","originX","originY","scaleDiff","newTranslateX","newTranslateY","onTouchEnd","onWheel","delta","onDoubleClick","resetTransform","setTransform","useEffect","handleTouchStartNative","e","handleTouchMoveNative","handleTouchEndNative","refs","YarnParameters","onChange","hoopDiameterMM","imgSizePx","initialSpec","disabled","spec","setSpec","tex","normalizeToTex","diameterMM","calculateDiameterMM","threadThicknessMM","calculateThreadThicknessMM","lineWeight","calculateLineWeight","onChangeRef","React","updateSpec","updates","prev","handleTypeChange","value","handleMaterialChange","parseNumber","val","jsxs","Card","CardHeader","jsx","CardContent","Select","SelectTrigger","SelectValue","SelectContent","SelectItem","Fragment","Accordion","AccordionItem","AccordionTrigger","AccordionContent","App","selectedImage","setSelectedImage","isProcessing","setIsProcessing","result","setResult","progress","setProgress","error","setError","selectedPreset","setSelectedPreset","isMobileMenuOpen","setIsMobileMenuOpen","fileInputRef","timeoutRef","scrollTimeoutRef","mobileCanvasRef","canvasTransform","canvasHandlers","numberOfPins","setNumberOfPins","numberOfLines","setNumberOfLines","setLineWeight","imgSize","setImgSize","frameDiameter","setFrameDiameter","yarnSpec","setYarnSpec","presets","sections","applyPreset","presetId","preset","p","handleNavigation","section","element","toggleMobileMenu","handleScrollToTop","handleDownload","link","handleDownloadPDF","doc","jsPDF","margin","y","pageWidth","a4Width","a4Height","frameDiameterMm","fullPageSize","canvasSize","ctx","pinCoords","i","p1","p2","previewImgData","drawPreviewContent","offsetX","offsetY","drawTemplateContent","cx","cy","radius","r45","d1x","d1y","pinRadius","numPins","pin","imgCenter","angle","x","labelDist","labelX","labelY","cols","rows","r","c","colWidth","rowsPerColumn","currentStep","sequence","totalSteps","col","xBase","row","fromPin","toPin","stepNumber","handleDownloadTemplateImage","arcPerPin","fontSize","handleDownloadTXT","content","blob","handleTryAgain","timer","overlay","isDragOver","setIsDragOver","processFile","file","reader","handleImageUpload","handleDragOver","handleDragLeave","handleDrop","imageFile","generateArt","resultSection","img","stringArtResult","generateStringArt","progressUpdate","currentLineSequence","pinCoordinates","drawProgressiveLines","errorMessage","handleCanvasInteraction","lineSequence","currentImgSize","upToLineIndex","currentTransform","linesToDraw","pin1Index","pin2Index","pin1","pin2","AppHeader","NavigationDots","HeroSection","MobileSlider","weight","Button","CanvasErrorBoundary","Progress","GallerySection","TutorialSection","FAQSection","FloatingActions","createRoot","StrictMode"],"mappings":"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"}